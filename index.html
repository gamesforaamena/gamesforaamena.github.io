<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aamena's Phonics Game</title>
    <style>
        /* CUSTOM HAND CURSOR applied to everything */
        * { 
            margin: 0; padding: 0; box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent;
            cursor: url('image_2a7f29.png'), auto !important;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: #a29bfe;
            height: 100vh; height: 100dvh;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden; padding: 10px;
        }

        .container {
            background: white;
            border-radius: 30px; padding: 15px;
            box-shadow: 0 15px 0px rgba(0,0,0,0.1), 0 30px 50px rgba(0,0,0,0.2);
            max-width: 450px; width: 100%; height: 98%;
            display: flex; flex-direction: column; position: relative;
            border: 8px solid #fff;
        }

        h1 { text-align: center; color: #6c5ce7; font-size: 1.5em; margin: 5px 0; }

        .menu-screen, .game-screen, .settings-screen { display: none; flex-direction: column; height: 100%; overflow: hidden; }
        .active { display: flex !important; }

        /* FANCY COMPLETION BOX (Funky Text Box) */
        .overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255,255,255,0.98); display: none;
            flex-direction: column; align-items: center; justify-content: center;
            z-index: 1000; border-radius: 30px; text-align: center;
            padding: 20px;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        .fancy-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 30px; border-radius: 25px; color: white;
            box-shadow: 0 10px 0px #d63031; border: 5px solid white;
        }

        /* LEVEL TILES (English Menu) */
        .level-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 5px; flex-grow: 1; overflow-y: auto; }
        .level-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px; padding: 12px; color: white; border: none;
            box-shadow: 0 5px 0px #d63031; text-align: center; font-weight: bold;
        }

        /* VOICE LIST */
        .voice-list { flex-grow: 1; overflow-y: auto; margin: 10px 0; border: 2px solid #eee; border-radius: 15px; padding: 5px; }
        .voice-option { padding: 10px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; font-size: 0.9em; }
        .voice-option.selected { background: #efeeff; border-left: 4px solid #6c5ce7; }

        /* GAMEPLAY (English Left-to-Right) */
        .word-image { text-align: center; font-size: 4.5em; margin: 10px 0; }
        .target-boxes { display: flex; justify-content: center; gap: 8px; margin: 15px 0; flex-wrap: wrap;}
        .target-box {
            width: 55px; height: 75px; border: 3px dashed #dfe6e9; border-radius: 12px;
            background: #f9f9f9; display: flex; align-items: center; justify-content: center;
            font-size: 2.2em; font-weight: 900; color: #6c5ce7;
        }
        .target-box.filled { border: 3px solid #6c5ce7; background: #fff; animation: bounce 0.4s; }
        .letter-tile {
            width: 60px; height: 60px; background: #6c5ce7; border-radius: 15px;
            display: flex; align-items: center; justify-content: center;
            font-size: 2.2em; font-weight: 900; color: white;
            box-shadow: 0 6px 0px #4834d4;
        }
        .hidden { visibility: hidden; opacity: 0; }

        .btn-main { padding: 12px 30px; background: #00b894; color: white; border: none; border-radius: 50px; font-weight: 900; box-shadow: 0 5px 0px #009475; }
        .btn-sec { background: #dfe6e9; color: #636e72; padding: 8px 15px; border-radius: 12px; border: none; font-size: 0.9em; font-weight: bold; }

        @keyframes bounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
    </style>
</head>
<body>

    <div class="container">
        <div class="overlay" id="successOverlay">
            <div class="fancy-box">
                <div style="font-size: 4em;">üèÜ</div>
                <h2 style="margin-bottom: 10px;">AMAZING JOB!</h2>
                <p id="successText" style="margin-bottom: 20px; font-weight: bold;"></p>
                <button class="btn-main" onclick="location.reload()">Play Again</button>
            </div>
        </div>

        <div class="settings-screen" id="settingsScreen">
            <h1>Select Urdu Voice</h1>
            <p style="font-size: 0.8em; text-align: center; color: #666;">Choose a voice for Urdu translations:</p>
            <div class="voice-list" id="voiceList"></div>
            <button class="btn-main" onclick="hideSettings()">Save & Close</button>
        </div>

        <div class="menu-screen active" id="menuScreen">
            <div style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h1>Aamena's Phonics</h1>
                <button class="btn-sec" onclick="showSettings()">‚öôÔ∏è Voice</button>
            </div>
            <div class="level-grid" id="levelGrid"></div>
        </div>

        <div class="game-screen" id="gameScreen">
            <div style="display:flex; justify-content: space-between; align-items: center;">
                <button class="btn-sec" onclick="location.reload()">‚¨Ö Back</button>
                <div id="progress" style="font-weight: 800; color: #b2bec3;"></div>
            </div>
            <div class="word-image" id="wordImage"></div>
            <div style="text-align: center; margin-bottom: 5px;">
                <button id="speakBtn" style="border:none; background:#fab1a0; color:white; width:50px; height:50px; border-radius:50%; font-size: 1.5em; box-shadow: 0 4px 0px #e17055;">üîä</button>
            </div>
            <div class="target-boxes" id="targetBoxes"></div>
            <div class="letter-tiles" id="letterTiles" style="display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-top:auto; padding-bottom:20px;"></div>
        </div>
    </div>

    <script>
        // Reverted to English Word Database
        const wordDatabase = {
            'AD Family': [{word:'BAD', emoji:'üëé'},{word:'DAD', emoji:'üë®'},{word:'SAD', emoji:'üò¢'}],
            'AM Family': [{word:'JAM', emoji:'üçì'},{word:'HAM', emoji:'üçñ'},{word:'RAM', emoji:'üêè'}],
            'AT Family': [{word:'CAT', emoji:'üê±'},{word:'HAT', emoji:'üé©'},{word:'BAT', emoji:'ü¶á'}],
            'AN Family': [{word:'VAN', emoji:'üöê'},{word:'FAN', emoji:'ü™≠'},{word:'CAN', emoji:'ü•´'}],
            'AP Family': [{word:'CAP', emoji:'üß¢'},{word:'MAP', emoji:'üó∫Ô∏è'},{word:'TAP', emoji:'üö∞'}],
            'Hard Words': [{word:'COMBAT', emoji:'‚öîÔ∏è'},{word:'ACROBAT', emoji:'ü§∏'}]
        };

        let currentWords = [], currentIdx = 0, targetWord = "", attempt = [], draggedTile = null, selectedVoice = null;

        // VOICE SELECTOR (Filtered for Urdu/Hindi support)
        function loadVoices() {
            const voices = window.speechSynthesis.getVoices();
            const list = document.getElementById('voiceList');
            list.innerHTML = '';
            
            // Prioritize Urdu or Hindi voices for the accent
            const filtered = voices.filter(v => v.lang.includes('ur') || v.lang.includes('hi'));

            filtered.forEach(voice => {
                const div = document.createElement('div');
                div.className = `voice-option ${selectedVoice?.name === voice.name ? 'selected' : ''}`;
                div.innerHTML = `<span>${voice.name} (${voice.lang})</span><button class="btn-sec" onclick="testVoice('${voice.name}')">‚ñ∂</button>`;
                div.onclick = (e) => { if(e.target.tagName !== 'BUTTON') { selectedVoice = voice; loadVoices(); } };
                list.appendChild(div);
            });
        }
        window.speechSynthesis.onvoiceschanged = loadVoices;

        function testVoice(name) {
            const v = window.speechSynthesis.getVoices().find(v => v.name === name);
            const m = new SpeechSynthesisUtterance("Hello Aamena, how do I sound?");
            m.voice = v; window.speechSynthesis.speak(m);
        }

        function speak(text) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            if (selectedVoice) msg.voice = selectedVoice;
            msg.rate = 0.8; 
            window.speechSynthesis.speak(msg);
        }

        function showSettings() { document.getElementById('menuScreen').classList.remove('active'); document.getElementById('settingsScreen').classList.add('active'); loadVoices(); }
        function hideSettings() { document.getElementById('settingsScreen').classList.remove('active'); document.getElementById('menuScreen').classList.add('active'); }

        // MENU BUILDER (English Labels)
        const grid = document.getElementById('levelGrid');
        Object.keys(wordDatabase).forEach(family => {
            const btn = document.createElement('div');
            btn.className = 'level-card';
            btn.innerHTML = `<div style="font-size:1.8em">${wordDatabase[family][0].emoji}</div><div>${family}</div>`;
            btn.onclick = () => {
                currentWords = [...wordDatabase[family]]; currentIdx = 0;
                document.getElementById('menuScreen').classList.remove('active');
                document.getElementById('gameScreen').classList.add('active');
                loadWord();
            };
            grid.appendChild(btn);
        });

        function loadWord() {
            if (currentIdx >= currentWords.length) {
                document.getElementById('successText').textContent = "You finished all the words!";
                document.getElementById('successOverlay').style.display = 'flex';
                speak("Congratulations Aamena!"); return;
            }
            const data = currentWords[currentIdx];
            targetWord = data.word; attempt = new Array(targetWord.length).fill(null);
            document.getElementById('wordImage').textContent = data.emoji;
            document.getElementById('progress').textContent = `${currentIdx + 1} / ${currentWords.length}`;

            const tBox = document.getElementById('targetBoxes'); tBox.innerHTML = '';
            targetWord.split('').forEach((_, i) => {
                const b = document.createElement('div'); b.className = 'target-box'; b.dataset.idx = i;
                b.ondragover = (e) => e.preventDefault();
                b.ondrop = (e) => handleDrop(b, draggedTile);
                tBox.appendChild(b);
            });

            const lTiles = document.getElementById('letterTiles'); lTiles.innerHTML = '';
            targetWord.split('').sort(() => Math.random() - 0.5).forEach(char => {
                const t = document.createElement('div'); t.className = 'letter-tile'; t.textContent = char;
                t.draggable = true; t.ondragstart = () => { draggedTile = t; };
                t.ontouchstart = () => { draggedTile = t; };
                t.ontouchend = (e) => {
                    const touch = e.changedTouches[0];
                    const box = document.elementFromPoint(touch.clientX, touch.clientY)?.closest('.target-box');
                    if(box) handleDrop(box, t);
                };
                lTiles.appendChild(t);
            });
            speak(targetWord);
        }

        function handleDrop(box, tile) {
            if (!tile || box.textContent) return;
            box.textContent = tile.textContent; box.classList.add('filled'); tile.classList.add('hidden');
            attempt[box.dataset.idx] = tile.textContent;
            if (attempt.every(l => l !== null)) {
                if(attempt.join('') === targetWord) { speak("Well done!"); setTimeout(() => { currentIdx++; loadWord(); }, 1200); }
                else { speak("Try again"); setTimeout(loadWord, 800); }
            }
        }

        document.getElementById('speakBtn').onclick = () => speak(targetWord);
    </script>
</body>
</html>
